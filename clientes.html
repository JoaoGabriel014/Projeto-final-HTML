<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <title>Clientes - Locadora</title>
  <script src="https://unpkg.com/feather-icons"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    boby{
     background-color: #f5f6fa;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }

    .navbar {
      background-color: #002b64;
    }

    .navbar a {
      color: white !important;
      font-weight: 500;
      margin-left: 15px;
      text-decoration: none;
    }

    .navbar a:hover {
      text-decoration: underline;
    }

    .table-responsive {
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }

    img.rounded-circle {
      object-fit: cover;
    }

    @media (max-width: 768px) {
      nav .btn {
        margin-top: 5px;
        width: 100%;
      }

      .offcanvas {
        width: 100% !important;
      }

      body {
        padding: 10px;
      }
    }

    @media (prefers-color-scheme: dark) {
      body {
        background-color: #ececec;
        color: #000000;
      }

      .card,
      .offcanvas,
      table {
        background-color: #dddddd;
        color: #000000;
      }

      .table-dark th {
        background-color: #1b1b1b !important;
      }
    }
  </style>
</head>

<body>

<nav class="navbar navbar-expand-lg px-4" style="background-color: #002b64; padding-top: 12px; padding-bottom: 12px;">
  <a href="dashboard.html" class="d-flex align-items-center">
    <img src="img/AutoLogo.png" alt="Autoflex" style="max-height: 20px; object-fit: contain;">
    <span class="ms-2 text-white fw-bold"></span>
  </a>
  <div class="ms-auto d-flex align-items-center">
    <a href="clientes.html">Clientes</a>
    <a href="veiculos.html">Ve√≠culos</a>
    <a href="index.html">Sair</a>
  </div>
</nav>

  <div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center flex-wrap">
      <h2 class="mt-3">Clientes</h2>
      <div>
        <a href="#add-cliente" data-bs-toggle="offcanvas" class="btn btn-dark rounded-pill" id="novoClienteBtn">Novo Cliente</a>
      </div>
    </div>
  </div>

  <!-- CAMPO DE BUSCA -->
  <div class="container mb-3">
    <input type="text" id="buscaCliente" class="form-control"
      placeholder="üîç Buscar cliente por nome, CPF, telefone ou endere√ßo...">
  </div>

  <!-- OFFCANVAS FORM -->
  <div id="add-cliente" class="offcanvas offcanvas-start">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title" id="tituloForm">Novo Cliente</h5>
    </div>
    <div class="offcanvas-body">
      <form id="clienteForm">
        <input type="hidden" id="editIndex">

        <label for="nome">Nome</label>
        <input type="text" id="nome" placeholder="Digite aqui" class="form-control mb-3" required>

        <label for="foto">Foto</label>
        <input type="file" id="foto" class="form-control mb-3">

        <label for="telefone">Telefone</label>
        <input type="tel" id="telefone" placeholder="(00) 00000-0000" maxlength="15" class="form-control mb-3" required>

        <label for="endereco">Endere√ßo</label>
        <input type="text" id="endereco" placeholder="Rua, n√∫mero, bairro..." class="form-control mb-3" required>

        <label for="cpf">CPF</label>
        <input type="text" id="cpf" placeholder="000.000.000-00" maxlength="14" class="form-control mb-3" required>

        <button type="submit" class="btn btn-light btn-custom btn-green">
          <i data-feather="check-circle"></i> Salvar
        </button>
      </form>
    </div>
  </div>

  <hr>

<div class="container mb-3 text-center">
  <button id="toggleTabelaBtn" class="btn btn-secondary rounded-pill d-flex align-items-center justify-content-center gap-2 mx-auto">
    <i data-feather="eye"></i>
    <span>Ocultar tabela</span>
  </button>
</div>

  <!-- TABELA -->
  <section id="tabelaClientes" class="card card-body">
    <div class="container table-responsive">
      <table class="table table-striped table-bordered">
        <thead class="table table-dark">
          <tr>
            <th>#ID</th>
            <th>CPF</th>
            <th>Foto</th>
            <th>Nome</th>
            <th>Telefone</th>
            <th>Endere√ßo</th>
            <th>A√ß√µes</th>
          </tr>
        </thead>
        <tbody id="clientesList">
          <tr>
            <td>1</td>
            <td>123.456.789-00</td>
            <td><img class="rounded-circle" src="https://randomuser.me/api/portraits/men/10.jpg" width="50"></td>
            <td>Lucas Almeida</td>
            <td>(11) 98888-1234</td>
            <td>Rua das Flores, 45 - S√£o Paulo/SP</td>
            <td>
              <button class="btn btn-sm btn-outline-primary rounded-pill  rounded-pill rounded-pillrounded-pill" onclick="editarCliente(this)">Editar</button>
              <button class="btn btn-sm btn-outline-danger rounded-pill  rounded-pill rounded-pillrounded-pill" onclick="excluirCliente(this)">Excluir</button>
            </td>
          </tr>
          <tr>
            <td>2</td>
            <td>987.654.321-11</td>
            <td><img class="rounded-circle" src="https://randomuser.me/api/portraits/women/20.jpg" width="50"></td>
            <td>Ana Souza</td>
            <td>(21) 97777-4321</td>
            <td>Av. Atl√¢ntica, 900 - Rio de Janeiro/RJ</td>
            <td>
              <button class="btn btn-sm btn-outline-primary rounded-pill  rounded-pill rounded-pillrounded-pill" onclick="editarCliente(this)">Editar</button>
              <button class="btn btn-sm btn-outline-danger rounded-pill  rounded-pill rounded-pillrounded-pill" onclick="excluirCliente(this)">Excluir</button>
            </td>
          </tr>
          <tr>
            <td>3</td>
            <td>321.654.987-22</td>
            <td><img class="rounded-circle" src="https://randomuser.me/api/portraits/men/33.jpg" width="50"></td>
            <td>Marcos Silva</td>
            <td>(31) 99876-5555</td>
            <td>Rua Minas Gerais, 120 - Belo Horizonte/MG</td>
            <td>
              <button class="btn btn-sm btn-outline-primary rounded-pill" onclick="editarCliente(this)">Editar</button>
              <button class="btn btn-sm btn-outline-danger rounded-pill" onclick="excluirCliente(this)">Excluir</button>
            </td>
          </tr>
          <tr>
            <td>4</td>
            <td>654.987.321-33</td>
            <td><img class="rounded-circle" src="https://randomuser.me/api/portraits/women/44.jpg" width="50"></td>
            <td>Fernanda Lima</td>
            <td>(41) 98822-9090</td>
            <td>Rua XV de Novembro, 300 - Curitiba/PR</td>
            <td>
              <button class="btn btn-sm btn-outline-primary rounded-pill" onclick="editarCliente(this)">Editar</button>
              <button class="btn btn-sm btn-outline-danger rounded-pill" onclick="excluirCliente(this)">Excluir</button>
            </td>
          </tr>
          <tr>
            <td>5</td>
            <td>852.963.741-44</td>
            <td><img class="rounded-circle" src="https://randomuser.me/api/portraits/men/50.jpg" width="50"></td>
            <td>Rafael Costa</td>
            <td>(71) 97711-2233</td>
            <td>Rua Bahia, 77 - Salvador/BA</td>
            <td>
              <button class="btn btn-sm btn-outline-primary  rounded-pill rounded-pillrounded-pill" onclick="editarCliente(this)">Editar</button>
              <button class="btn btn-sm btn-outline-danger  rounded-pill rounded-pillrounded-pill" onclick="excluirCliente(this)">Excluir</button>
            </td>
          </tr>
          <tr>
            <td>6</td>
            <td>951.753.852-55</td>
            <td><img class="rounded-circle" src="https://randomuser.me/api/portraits/women/65.jpg" width="50"></td>
            <td>Camila Ferreira</td>
            <td>(51) 98899-3344</td>
            <td>Rua dos Andradas, 999 - Porto Alegre/RS</td>
            <td>
              <button class="btn btn-sm btn-outline-primary  rounded-pill rounded-pillrounded-pill" onclick="editarCliente(this)">Editar</button>
              <button class="btn btn-sm btn-outline-danger  rounded-pill rounded-pillrounded-pill" onclick="excluirCliente(this)">Excluir</button>
            </td>
          </tr>
          <tr>
            <td>7</td>
            <td>147.258.369-66</td>
            <td><img class="rounded-circle" src="https://randomuser.me/api/portraits/men/70.jpg" width="50"></td>
            <td>Diego Moreira</td>
            <td>(85) 98877-4455</td>
            <td>Av. Beira Mar, 2300 - Fortaleza/CE</td>
            <td>
              <button class="btn btn-sm btn-outline-primary rounded-pill rounded-pill" onclick="editarCliente(this)">Editar</button>
              <button class="btn btn-sm btn-outline-danger rounded-pill rounded-pill" onclick="excluirCliente(this)">Excluir</button>
            </td>
          </tr>
          <tr>
            <td>8</td>
            <td>369.258.147-77</td>
            <td><img class="rounded-circle" src="https://randomuser.me/api/portraits/women/80.jpg" width="50"></td>
            <td>Juliana Pereira</td>
            <td>(62) 98866-7788</td>
            <td>Rua Goi√°s, 145 - Goi√¢nia/GO</td>
            <td>
              <button class="btn btn-sm btn-outline-primary rounded-pill rounded-pill" onclick="editarCliente(this)">Editar</button>
              <button class="btn btn-sm btn-outline-danger rounded-pill rounded-pill" onclick="excluirCliente(this)">Excluir</button>
            </td>
          </tr>
          <tr>
            <td>9</td>
            <td>753.159.486-88</td>
            <td><img class="rounded-circle" src="https://randomuser.me/api/portraits/men/90.jpg" width="50"></td>
            <td>Jos√© Oliveira</td>
            <td>(41) 98855-6677</td>
            <td>Rua Paran√°, 33 - Curitiba/PR</td>
            <td>
              <button class="btn btn-sm btn-outline-primary rounded-pill" onclick="editarCliente(this)">Editar</button>
              <button class="btn btn-sm btn-outline-danger rounded-pill" onclick="excluirCliente(this)">Excluir</button>
            </td>
          </tr>
          <tr>
            <td>10</td>
            <td>951.741.258-99</td>
            <td><img class="rounded-circle" src="https://randomuser.me/api/portraits/women/95.jpg" width="50"></td>
            <td>Patricia Costa</td>
            <td>(61) 99844-5566</td>
            <td>Av. W3, 678 - Bras√≠lia/DF</td>
            <td>
              <button class="btn btn-sm btn-outline-primary rounded-pill" onclick="editarCliente(this)">Editar</button>
              <button class="btn btn-sm btn-outline-danger rounded-pill" onclick="excluirCliente(this)">Excluir</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://unpkg.com/feather-icons"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>


  <script>
    const form = document.getElementById("clienteForm");
    const clientesList = document.getElementById("clientesList");
    const buscaInput = document.getElementById("buscaCliente");
    const MAX_CLIENTES = 10;
    let clientId = clientesList.rows.length + 1;
    let editMode = false;
    let editRow = null;

    buscaInput.addEventListener("input", function () {
      const termo = this.value.toLowerCase();
      const linhas = clientesList.getElementsByTagName("tr");
      for (let linha of linhas) {
        linha.style.display = linha.textContent.toLowerCase().includes(termo) ? "" : "none";
      }
    });

    const nomeInput = document.getElementById("nome");
    nomeInput.addEventListener("input", function (e) {
      const value = e.target.value;
      if (/\d/.test(value)) {
        e.target.value = value.replace(/\d/g, "");
        if (e.inputType !== "deleteContentBackward") alert("‚ö†Ô∏è O campo 'Nome' n√£o pode conter n√∫meros!");
      }
    });

    const cpfInput = document.getElementById("cpf");
    cpfInput.addEventListener("input", function (e) {
      let value = e.target.value.replace(/\D/g, "");
      if (e.data && /[A-Za-z]/.test(e.data)) alert("‚ö†Ô∏è O campo 'CPF' deve conter apenas n√∫meros!");
      if (value.length > 11) value = value.slice(0, 11);
      if (value.length > 9) value = value.replace(/(\d{3})(\d{3})(\d{3})(\d{0,2})/, "$1.$2.$3-$4");
      else if (value.length > 6) value = value.replace(/(\d{3})(\d{3})(\d{0,3})/, "$1.$2.$3");
      else if (value.length > 3) value = value.replace(/(\d{3})(\d{0,3})/, "$1.$2");
      e.target.value = value;
    });

    const telInput = document.getElementById("telefone");
    telInput.addEventListener("input", function (e) {
      let value = e.target.value.replace(/\D/g, "");
      if (e.data && /[A-Za-z]/.test(e.data)) alert("‚ö†Ô∏è O campo 'Telefone' deve conter apenas n√∫meros!");
      if (value.length > 11) value = value.slice(0, 11);
      if (value.length > 6) value = value.replace(/(\d{2})(\d{5})(\d{0,4})/, "($1) $2-$3");
      else if (value.length > 2) value = value.replace(/(\d{2})(\d{0,5})/, "($1) $2");
      else value = value.replace(/(\d{0,2})/, "($1");
      e.target.value = value;
    });

    document.getElementById("novoClienteBtn").addEventListener("click", () => {
      form.reset();
      editMode = false;
      editRow = null;
      document.getElementById("tituloForm").textContent = "Novo Cliente";
    });

    form.addEventListener("submit", (e) => {
      e.preventDefault();

      const nome = document.getElementById("nome").value.trim();
      const telefone = document.getElementById("telefone").value.trim();
      const endereco = document.getElementById("endereco").value.trim();
      const cpf = document.getElementById("cpf").value.trim();
      const fotoInput = document.getElementById("foto");
      const foto = fotoInput.files[0] ? URL.createObjectURL(fotoInput.files[0]) : "https://via.placeholder.com/50";

      if (nome === "" || /\d/.test(nome)) {
        alert("‚ö†Ô∏è O nome n√£o pode conter n√∫meros nem estar vazio!");
        return;
      }

      if (!/^\(\d{2}\) \d{5}-\d{4}$/.test(telefone)) {
        alert("‚ö†Ô∏è Telefone inv√°lido! Use o formato (00) 00000-0000.");
        return;
      }

      if (!/^\d{3}\.\d{3}\.\d{3}-\d{2}$/.test(cpf)) {
        alert("‚ö†Ô∏è CPF inv√°lido! Use o formato 000.000.000-00.");
        return;
      }

      if (!editMode) {
        if (clientesList.rows.length >= MAX_CLIENTES) {
          alert("‚ö†Ô∏è Limite m√°ximo de " + MAX_CLIENTES + " clientes atingido!");
          return;
        }

        for (let row of clientesList.rows) {
          const cpfExistente = row.cells[1].textContent;
          const telExistente = row.cells[4].textContent;
          if (cpfExistente === cpf) {
            alert("‚ùå Este CPF j√° est√° cadastrado!");
            return;
          }
          if (telExistente === telefone) {
            alert("‚ùå Este telefone j√° est√° cadastrado!");
            return;
          }
        }

        const novaLinha = document.createElement("tr");
        novaLinha.innerHTML = `
          <td>${clientId++}</td>
          <td>${cpf}</td>
          <td><img class="rounded-circle" src="${foto}" width="50"></td>
          <td>${nome}</td>
          <td>${telefone}</td>
          <td>${endereco}</td>
          <td>
            <button class="btn btn-sm btn-primary" onclick="editarCliente(this)">Editar</button>
            <button class="btn btn-sm btn-danger" onclick="excluirCliente(this)">Excluir</button>
          </td>`;
        clientesList.appendChild(novaLinha);
      } else if (editRow) {
        editRow.cells[1].textContent = cpf;
        if (fotoInput.files[0]) editRow.cells[2].innerHTML = `<img class="rounded-circle" src="${foto}" width="50">`;
        editRow.cells[3].textContent = nome;
        editRow.cells[4].textContent = telefone;
        editRow.cells[5].textContent = endereco;
        alert("‚úÖ Cliente atualizado com sucesso!");
      }

      form.reset();
      const offcanvas = bootstrap.Offcanvas.getInstance(document.getElementById("add-cliente"));
      offcanvas.hide();
      editMode = false;
      editRow = null;
    });

    function excluirCliente(botao) {
      if (confirm("Tem certeza que deseja excluir este cliente?")) botao.closest("tr").remove();
    }

    function editarCliente(botao) {
      const row = botao.closest("tr");
      editMode = true;
      editRow = row;
      document.getElementById("cpf").value = row.cells[1].textContent;
      document.getElementById("nome").value = row.cells[3].textContent;
      document.getElementById("telefone").value = row.cells[4].textContent;
      document.getElementById("endereco").value = row.cells[5].textContent;
      document.getElementById("tituloForm").textContent = "Editar Cliente";
      const offcanvas = new bootstrap.Offcanvas(document.getElementById("add-cliente"));
      offcanvas.show();
    }
  </script>

<script>
  feather.replace();

  const toggleBtn = document.getElementById("toggleTabelaBtn");
  const tabela = document.getElementById("tabelaClientes");

  toggleBtn.addEventListener("click", () => {
    const ocultando = tabela.style.display !== "none";

    // alterna a visibilidade
    tabela.style.display = ocultando ? "none" : "";

    // troca √≠cone e texto
    toggleBtn.innerHTML = ocultando
      ? `${feather.icons["eye-off"].toSvg()} <span>Mostrar tabela</span>`
      : `${feather.icons["eye"].toSvg()} <span>Ocultar tabela</span>`;
  });
</script>
</body>

</html>
